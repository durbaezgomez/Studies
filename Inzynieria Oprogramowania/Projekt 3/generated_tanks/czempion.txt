function (e) { var response = {}; myTank = e.data.myTank; enemyTank = e.data.enemyTank; var bullet0 = {}; if(enemyTank.bullets[0]) {bullet0.x = enemyTank.bullets[0].x;bullet0.y = enemyTank.bullets[0].y; } else {bullet0.x = 0;bullet0.y = 0; } var bullet1 = {};if(enemyTank.bullets[1]) {bullet1.x = enemyTank.bullets[1].x;bullet1.y = enemyTank.bullets[1].y; } else {bullet1.x = 0;bullet1.y = 0; }var input = [myTank.x, myTank.y, myTank.rotation, myTank.shootCooldown, enemyTank.x, enemyTank.y, enemyTank.cannonRotation, bullet0.x, bullet0.y, bullet1.x, bullet1.y]; var weights1 = [-0.5656202157080106, -2.44252546685522, 0.18409878088447584, 3.785995092762259, 3.854913382925271, 0.5198127559915386, 3.439228532173301, -1.322437722920311, -0.8148334533691726, -1.023168337182872, -2.1121789376882596, 2.548748622052641, 0.07924019977497565, -0.1649664575813361, 0.6968045360489796, -0.38155721723110325, 3.0790457783201113, 1.2371913607344078, 0.8163501980949004, -3.8344175243053504, -0.6009939380850469, 3.0196311858405283, 0.11628852071761298, 0.024921492981374804, 1.10324930668481, 1.7315033269335984, -3.116536956960754, 2.8746268135168176, -3.9303263018259473, -2.6924901483228583, -2.7602233579176447, 2.7684967983526843, 2.269751115727545, 0.25380409525519365, -0.3607321289516605, 2.465214850343994, -3.4209823992609847, 0.7282798174315293, -1.8257669281742235, 2.027492270257251, 3.983993139403446, 1.295589665406113, -3.122241835411601, -2.6829816319662703]; var bias1 = [-0.5656202157080106, -2.44252546685522, 0.18409878088447584, 3.785995092762259, 3.854913382925271, 0.5198127559915386, 3.439228532173301, -1.322437722920311, -0.8148334533691726, -1.023168337182872, -2.1121789376882596, 2.548748622052641, 0.07924019977497565, -0.1649664575813361, 0.6968045360489796, -0.38155721723110325, 3.0790457783201113, 1.2371913607344078, 0.8163501980949004, -3.8344175243053504, -0.6009939380850469, 3.0196311858405283, 0.11628852071761298, 0.024921492981374804, 1.10324930668481, 1.7315033269335984, -3.116536956960754, 2.8746268135168176, -3.9303263018259473, -2.6924901483228583, -2.7602233579176447, 2.7684967983526843, 2.269751115727545, 0.25380409525519365, -0.3607321289516605, 2.465214850343994, -3.4209823992609847, 0.7282798174315293, -1.8257669281742235, 2.027492270257251, 3.983993139403446, 1.295589665406113, -3.122241835411601, -2.6829816319662703]; var hidden = [0, 0, 0, 0]; var i, j; for (i = 0; i < 4; i++) { for (j = 0; j < 11; j++) hidden[i] += input[j] * weights1[i * 11 + j]; hidden[i] = hidden[i] + bias1[i]; hidden[i] = 1 / (1 + Math.pow(Math.E, -hidden[i])); } var weights2 = [0.2603050384319259, 3.632217473471135, -0.8947722524561899, -3.4734634154347397, -1.5314705722955688, -0.09060440662813729, 2.342148835103669, 3.43993330964652, 3.7719205743643265, -2.9488919800818296, 1.5434732838342216, -1.5810133621795313, -0.06789151726513065, -0.8886321214426385, -3.920933371072099, -2.19369362938445, 0.085895019595009, -2.1639197159602643, 3.616774404407269, 2.366322182357125, -3.35917062219775, -1.5160849282586852, 2.113511380416944, -0.38617508362337016, 3.4730814345626797, 0.13614817676143076, 3.528333520434602, 3.6388162793201744]; var bias2 = [-1.7078313350948422, -2.6188689139316557, 1.5145414239712425, -2.7141661510775155, -0.2614555394585443, 0.45061174649225055, -3.3528560933403924]; var output = [0, 0, 0, 0, 0, 0, 0]; for (i = 0; i < 7; i++) { for (j = 0; j < 4; j++) output[i] += hidden[j] * weights2[i * 4 + j]; output[i] = output[i] + bias2[i]; output[i] = 1 / (1 + Math.pow(Math.E, -output[i])); output[i] = Math.round(output[i]); } response.turnLeft = output[0]; response.turnRight = output[1]; response.goForward = output[2]; response.goBack = output[3]; response.shoot = output[4]; response.cannonLeft = output[5]; response.cannonRight = output[6]; self.postMessage(response); } 